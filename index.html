<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<title>Popcat Online</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<style>
body{margin:0;font-family:sans-serif;background:#6a0dad;color:white;text-align:center;}
h1{margin:20px 0;}
.score{font-size:2em;margin-bottom:10px;}
img{width:220px;cursor:pointer;user-select:none;-webkit-user-drag:none;touch-action: manipulation;transition:0.1s;}
img:active{transform:scale(0.95);}
select{margin:10px;padding:6px 10px;border-radius:6px;font-size:16px;}
table{border-collapse:collapse;width:90%;max-width:600px;margin:20px auto;background:#fff;color:#222;border-radius:8px;overflow:hidden;}
th,td{padding:10px 14px;text-align:left;}
th{background:#eee;}
tr:nth-child(even){background:#fafafa;}
.country{display:flex;align-items:center;gap:8px;}
.country img{width:24px;height:16px;object-fit:cover;}
</style>
</head>
<body>

<h1>âš”ï¸ POPCAT ğŸ‡¹ğŸ‡­ VS ğŸ‡°ğŸ‡­ ğŸ—¡ï¸</h1>
<div>à¹€à¸¥à¸·à¸­à¸à¸›à¸£à¸°à¹€à¸—à¸¨à¸‚à¸­à¸‡à¸„à¸¸à¸“ | á‡áŸ’ášá¾áŸášá¾áŸá”áŸ’ášá‘áŸáŸášá”áŸáŸ‹á¢áŸ’á“á€:</div>
<select id="countrySelect">
  <option value="">ğŸ‡¹ğŸ‡­ğŸ‡°ğŸ‡­?????</option>
  <option value="ThailandğŸ‡¹ğŸ‡­">ğŸ‡¹ğŸ‡­ à¹„à¸—à¸¢ / Thailand</option>
  <option value="CambodiağŸ‡°ğŸ‡­">ğŸ‡°ğŸ‡­ á€á˜áŸ’á–á»á‡á¶ / Cambodia</option>
</select>

<div class="score">à¸„à¸°à¹à¸™à¸™ / á–á·á“áŸ’á‘á»: 0</div>
<img id="cat" src="images/cat_closed.png" alt="Pop Cat">
<audio id="sound" src="https://www.myinstants.com/media/sounds/pop-cat-original.mp3"></audio>
<audio id="bgMusic" src="https://www.example.com/à¹€à¸à¸¥à¸‡à¸‚à¸­à¸‡à¸„à¸¸à¸“.mp3" loop autoplay></audio>

<h2>ğŸŒ à¸„à¸°à¹à¸™à¸™à¸›à¸£à¸°à¹€à¸—à¸¨ / á–á·á“áŸ’á‘á»á‡á¶áá·á€áŸ’á“á»á„á”áŸ’ášá‘áŸáŸ</h2>
<table id="leaderboard">
<thead><tr><th>#</th><th>à¸›à¸£à¸°à¹€à¸—à¸¨ / á”áŸ’ášá‘áŸáŸ</th><th>à¸„à¸°à¹à¸™à¸™à¸£à¸§à¸¡ / á–á·á“áŸ’á‘á»áŸášá»á”</th></tr></thead>
<tbody></tbody>
</table>

<!-- Firebase SDK -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>

<script>
// Firebase Config
const firebaseConfig = {
  apiKey: "API_KEY",
  authDomain: "PROJECT_ID.firebaseapp.com",
  databaseURL: "https://PROJECT_ID-default-rtdb.firebaseio.com",
  projectId: "PROJECT_ID",
  storageBucket: "PROJECT_ID.appspot.com",
  messagingSenderId: "SENDER_ID",
  appId: "APP_ID"
};

firebase.initializeApp(firebaseConfig);
const db = firebase.database();

// Elements
const cat = document.getElementById("cat");
const scoreEl = document.querySelector(".score");
const sound = document.getElementById("sound");
const bgMusic = document.getElementById("bgMusic");
const countrySelect = document.getElementById("countrySelect");
const tbody = document.querySelector("#leaderboard tbody");

// à¹€à¸¥à¹ˆà¸™à¹€à¸à¸¥à¸‡à¸à¸·à¹‰à¸™à¸«à¸¥à¸±à¸‡
bgMusic.volume = 0.3;
bgMusic.play().catch(()=>{});

// à¸„à¸°à¹à¸™à¸™à¸ªà¹ˆà¸§à¸™à¸•à¸±à¸§
let myScore = localStorage.getItem("myScore") ? parseInt(localStorage.getItem("myScore")) : 0;
scoreEl.textContent = "à¸„à¸°à¹à¸™à¸™ / á–á·á“áŸ’á‘á»: " + myScore;

let open = false;

// à¸Ÿà¸±à¸‡à¸à¹Œà¸Šà¸±à¸™à¸­à¸±à¸›à¹€à¸”à¸•à¸•à¸²à¸£à¸²à¸‡
function updateTable(countries){
  let entries = Object.entries(countries);
  entries.sort((a,b)=>b[1]-a[1]);
  tbody.innerHTML = "";
  entries.forEach((item,idx)=>{
    let tr = document.createElement("tr");
    tr.innerHTML = `<td>${idx+1}</td><td class="country">${item[0]}</td><td>${item[1]}</td>`;
    tbody.appendChild(tr);
  });
}

// à¸Ÿà¸±à¸‡à¸‚à¹‰à¸­à¸¡à¸¹à¸¥ realtime
db.ref('countries').on('value', snapshot=>{
  let countries = snapshot.val() || {"ThailandğŸ‡¹ğŸ‡­":0,"CambodiağŸ‡°ğŸ‡­":0};
  updateTable(countries);
});

// à¸à¸” Popcat
cat.addEventListener("click", ()=>{
  const c = countrySelect.value;
  if(!c){ alert("à¸à¸£à¸¸à¸“à¸²à¹€à¸¥à¸·à¸­à¸à¸›à¸£à¸°à¹€à¸—à¸¨ / áŸá¼á˜á‡áŸ’ášá¾áŸá”áŸ’ášá‘áŸáŸášá”áŸáŸ‹á¢áŸ’á“á€!"); return; }

  // à¹€à¸à¸´à¹ˆà¸¡à¸„à¸°à¹à¸™à¸™à¸ªà¹ˆà¸§à¸™à¸•à¸±à¸§
  myScore++;
  localStorage.setItem("myScore", myScore);
  scoreEl.textContent = "à¸„à¸°à¹à¸™à¸™ / á–á·á“áŸ’á‘á»: " + myScore;

  // à¹€à¸¥à¹ˆà¸™à¹€à¸ªà¸µà¸¢à¸‡
  sound.currentTime = 0; sound.play();

  // à¹€à¸à¸´à¹ˆà¸¡à¸„à¸°à¹à¸™à¸™à¸›à¸£à¸°à¹€à¸—à¸¨à¸­à¸­à¸™à¹„à¸¥à¸™à¹Œà¹à¸šà¸šà¹€à¸£à¸µà¸¢à¸¥à¹„à¸—à¸¡à¹Œ
  const countryRef = db.ref('countries/' + c);
  countryRef.transaction(current => (current || 0) + 1);

  // à¹à¸ªà¸”à¸‡ animation Popcat à¹€à¸›à¸´à¸”-à¸›à¸´à¸”
  if(!open){
    cat.src = "images/cat_open.png";
    open = true;
    setTimeout(()=>{cat.src="images/cat_closed.png";open=false;},150);
  }
});
</script>
</body>
</html>
