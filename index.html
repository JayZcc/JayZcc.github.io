<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<title>Popcat Online</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<style>
body{
  margin:0;
  font-family:sans-serif;
  background:#6a0dad;
  color:white;
  text-align:center;
}
h1{margin:20px 0;}
.score{font-size:2em;margin-bottom:10px;}
img{
  width:220px;
  cursor:pointer;
  user-select:none;
  -webkit-user-drag:none;
  touch-action: manipulation;
  transition:0.1s;
}
img:active{transform:scale(0.95);}
select{
  margin:10px;
  padding:6px 10px;
  border-radius:6px;
  font-size:16px;
}
table{
  border-collapse:collapse;
  width:90%;
  max-width:600px;
  margin:20px auto;
  background:#fff;
  color:#222;
  border-radius:8px;
  overflow:hidden;
}
th,td{padding:10px 14px;text-align:left;}
th{background:#eee;}
tr:nth-child(even){background:#fafafa;}
.country{display:flex;align-items:center;gap:8px;}
.country img{width:24px;height:16px;object-fit:cover;}
</style>
</head>
<body>

<h1>⚔️ POPCAT 🇹🇭 VS 🇰🇭 🗡️</h1>
<div>เลือกประเทศของคุณ | ជ្រើសរើសប្រទេសរបស់អ្នក:</div>
<select id="countrySelect">
  <option value="">🇹🇭🇰🇭?????</option>
  <option value="Thailand🇹🇭">🇹🇭 ไทย / Thailand</option>
  <option value="Cambodia🇰🇭">🇰🇭 កម្ពុជា / Cambodia</option>
</select>

<div class="score">คะแนน / ពិន្ទុ: 0</div>
<img id="cat" src="https://cdn.discordapp.com/attachments/1403434383058403536/1406994419995119646/IMG_1621.jpg" alt="Pop Cat">
<audio id="sound" src="https://www.myinstants.com/media/sounds/pop-cat-original.mp3"></audio>
<audio id="bgMusic" src="https://www.example.com/เพลงของคุณ.mp3" loop autoplay></audio>

<h2>🌍 คะแนนระดับประเทศ / ពិន្ទុជាតិក្នុងប្រទេស</h2>
<table id="leaderboard">
<thead><tr><th>#</th><th>ประเทศ / ប្រទេស</th><th>คะแนนรวม / ពិន្ទុសរុប</th></tr></thead>
<tbody></tbody>
</table>

<!-- Firebase SDK -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>

<script>
// 🔹 Firebase Config
const firebaseConfig = {
  apiKey: "API_KEY",
  authDomain: "PROJECT_ID.firebaseapp.com",
  databaseURL: "https://PROJECT_ID-default-rtdb.firebaseio.com",
  projectId: "PROJECT_ID",
  storageBucket: "PROJECT_ID.appspot.com",
  messagingSenderId: "SENDER_ID",
  appId: "APP_ID"
};

firebase.initializeApp(firebaseConfig);
const db = firebase.database();

// 🔹 Elements
const cat = document.getElementById("cat");
const scoreEl = document.querySelector(".score");
const sound = document.getElementById("sound");
const bgMusic = document.getElementById("bgMusic");
const countrySelect = document.getElementById("countrySelect");
const tbody = document.querySelector("#leaderboard tbody");

bgMusic.volume = 0.3;
bgMusic.play().catch(()=>{});

// 🔹 Score ส่วนตัว
let myScore = 0;
let open = false;

// 🔹 ฟังก์ชันอัปเดตตาราง
function updateTable(countries){
  let entries = Object.entries(countries);
  entries.sort((a,b)=>b[1]-a[1]);
  tbody.innerHTML = "";
  entries.forEach((item,idx)=>{
    let tr = document.createElement("tr");
    tr.innerHTML = `<td>${idx+1}</td><td class="country">${item[0]}</td><td>${item[1]}</td>`;
    tbody.appendChild(tr);
  });
}

// 🔹 ฟังข้อมูล realtime
db.ref('countries').on('value', snapshot=>{
  let countries = snapshot.val() || {"Thailand🇹🇭":0,"Cambodia🇰🇭":0};
  updateTable(countries);
});

// 🔹 กด Popcat
cat.addEventListener("click", ()=>{
  const c = countrySelect.value;
  if(!c){
    alert("กรุณาเลือกประเทศ / សូមជ្រើសប្រទេសរបស់អ្នក!");
    return;
  }

  myScore++;
  scoreEl.textContent = "คะแนน / ពិន្ទុ: " + myScore;
  sound.currentTime = 0; sound.play();

  const countryRef = db.ref('countries/' + c);
  countryRef.transaction(current => (current || 0) + 1);
});
</script>
</body>
</html>
